<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/21.0.2"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.library.controller.MahasiswaController"
            stylesheets="@dashboard.css">

    <!-- ===== TOPBAR ===== -->
    <top>
        <HBox spacing="10" alignment="CENTER_LEFT" styleClass="topbar">
            <Label text="Dashboard Mahasiswa" styleClass="topbar-title"/>

            <Region HBox.hgrow="ALWAYS"/>

            <TextField fx:id="searchField" promptText="Cari buku..." styleClass="topbar-search"/>
            <Button text="Cari" onAction="#handleSearchTop" styleClass="topbar-btn"/>
            <Button text="Refresh" onAction="#handleRefresh" styleClass="topbar-btn"/>
            <Button text="Logout" onAction="#handleLogout" styleClass="btn-danger"/>
        </HBox>
    </top>

    <!-- ===== SIDEBAR ===== -->
    <left>
        <VBox spacing="10" styleClass="sidebar" prefWidth="240">
            <Label text="Kelompok 1" styleClass="sidebar-title"/>
            <Region styleClass="sidebar-line"/>

            <Button text="Home" styleClass="sidebar-btn" onAction="#goHome"/>
            <Button text="Cari &amp; Pinjam" styleClass="sidebar-btn" onAction="#goCari"/>
            <Button text="Pinjaman Saya" styleClass="sidebar-btn" onAction="#goPinjaman"/>

            <Region VBox.vgrow="ALWAYS"/>
            <Region styleClass="sidebar-line"/>

            <Label fx:id="loginInfoLabel" text="Login sebagai:" styleClass="sidebar-sub"/>
            <!-- Overdue notification (will be set by controller) -->
            <Label fx:id="overdueLabel" text="" styleClass="sidebar-overdue" wrapText="true"/>
        </VBox>
    </left>

    <!-- ===== CONTENT ===== -->
    <center>
        <StackPane styleClass="content-wrap">
            <VBox spacing="12" styleClass="content">

                <Label fx:id="pageTitleLabel"
                       text="Rekomendasi / Koleksi Buku"
                       styleClass="section-title"/>

                <!-- VIEW: HOME / CARI -->
                <ScrollPane fx:id="bookScroll"
                            fitToWidth="true"
                            fitToHeight="false"
                            pannable="true"
                            vbarPolicy="AS_NEEDED"
                            hbarPolicy="NEVER"
                            styleClass="book-scroll">
                    <content>
                        <TilePane fx:id="tileBooks"
                                  prefColumns="3"
                                  hgap="22" vgap="22"
                                  prefTileWidth="260"
                                  styleClass="book-tile"/>
                    </content>
                </ScrollPane>

                <!-- VIEW: PINJAMAN -->
                <VBox fx:id="loanPane" spacing="10" visible="false" managed="false">
                    <Label text="Riwayat / Status Peminjaman" styleClass="section-title"/>

                    <TableView fx:id="loanTable" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colLoanId" text="Loan ID" prefWidth="80"/>
                            <TableColumn fx:id="colBookTitle" text="Buku" prefWidth="280"/>
                            <TableColumn fx:id="colLoanDate" text="Pinjam" prefWidth="130"/>
                            <TableColumn fx:id="colDueDate" text="Due" prefWidth="130"/>
                            <TableColumn fx:id="colStatus" text="Status" prefWidth="140"/>
                            <TableColumn fx:id="colFine" text="Fine" prefWidth="90"/>
                        </columns>
                    </TableView>

                    <HBox spacing="10" alignment="CENTER_RIGHT">
                        <Button fx:id="btnReturn" text="Kembalikan" onAction="#handleReturnSelected" styleClass="topbar-btn"/>
                        <Button text="Refresh Pinjaman" onAction="#loadLoans" styleClass="topbar-btn"/>
                    </HBox>
                </VBox>

            </VBox>
        </StackPane>
    </center>

</BorderPane>
