<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/21.0.2"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.library.controller.PustakawanController"
            stylesheets="@dashboard.css">

    <!-- ===== TOPBAR ===== -->
    <top>
        <HBox spacing="14" styleClass="topbar" BorderPane.alignment="CENTER">
            <padding>
                <Insets top="14" right="18" bottom="14" left="18"/>
            </padding>

            <VBox spacing="2" HBox.hgrow="ALWAYS">
                <Label text="Dashboard Pustakawan" styleClass="topbar-title"/>
                <Label text="Kelola buku dan proses pengembalian" styleClass="topbar-sub"/>
            </VBox>

            <Button text="Refresh" onAction="#handleRefresh" styleClass="topbar-btn"/>
            <Button text="Logout" onAction="#handleLogout" styleClass="btn-danger"/>
        </HBox>
    </top>

    <!-- ===== SIDEBAR ===== -->
    <left>
        <VBox spacing="10" styleClass="sidebar" prefWidth="240" BorderPane.alignment="CENTER">
            <padding>
                <Insets top="18" right="14" bottom="18" left="14"/>
            </padding>

            <Label text="Menu" styleClass="sidebar-title"/>
            <Region styleClass="sidebar-line"/>

            <Button fx:id="btnMenuCrud" text="CRUD Buku" onAction="#goCrud" styleClass="sidebar-btn"/>
            <Button fx:id="btnMenuReturn" text="Pengembalian" onAction="#goReturn" styleClass="sidebar-btn"/>

            <Region VBox.vgrow="ALWAYS"/>

            <Region styleClass="sidebar-line"/>
            <Label fx:id="loginInfoLabel" text="Login sebagai: Pustakawan" styleClass="sidebar-item"/>
        </VBox>
    </left>

    <!-- ===== CONTENT ===== -->
    <center>
        <VBox styleClass="content" spacing="14">
            <padding>
                <Insets top="16" right="16" bottom="16" left="16"/>
            </padding>

            <!-- Title halaman -->
            <Label fx:id="pageTitleLabel" text="Manajemen Buku" styleClass="section-title"/>

            <!-- ====================== CRUD PANE ====================== -->
            <VBox fx:id="crudPane" spacing="12" styleClass="card">
                <padding>
                    <Insets top="16" right="16" bottom="16" left="16"/>
                </padding>

                <Label text="Cari, tambah, edit, dan hapus buku." styleClass="muted"/>

                <!-- SEARCH BAR + BUTTONS -->
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <TextField fx:id="searchBookField"
                               promptText="Cari judul..."
                               HBox.hgrow="ALWAYS"
                               styleClass="search-field"
                               onAction="#handleSearchBook"/>

                    <!-- âœ… INI YANG KAMU KURANG: tombol cari -->
                    <Button text="Cari" onAction="#handleSearchBook" styleClass="btn-ghost"/>

                    <Region HBox.hgrow="ALWAYS"/>

                    <Button text="Tambah" onAction="#handleAddBook" styleClass="btn-primary"/>
                    <Button text="Edit" onAction="#handleEditBook" styleClass="btn-ghost"/>
                    <Button text="Hapus" onAction="#handleDeleteBook" styleClass="btn-ghost"/>
                </HBox>

                <Label fx:id="bookMsgLabel" text="" styleClass="msg"/>

                <TableView fx:id="bookTable" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn fx:id="colId" text="ID" prefWidth="70"/>
                        <TableColumn fx:id="colTitle" text="Judul" prefWidth="380"/>
                        <TableColumn fx:id="colAuthor" text="Penulis" prefWidth="260"/>
                        <TableColumn fx:id="colStock" text="Stok" prefWidth="120"/>
                    </columns>
                </TableView>
            </VBox>

            <!-- ====================== RETURN PANE ====================== -->
            <VBox fx:id="returnPane" spacing="12" styleClass="card" visible="false" managed="false">
                <padding>
                    <Insets top="16" right="16" bottom="16" left="16"/>
                </padding>

                <Label text="Pilih salah satu lalu klik tombol Kembalikan." styleClass="muted"/>

                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Button text="Refresh Data" onAction="#handleRefresh" styleClass="btn-ghost"/>
                    <Button text="Kembalikan Terpilih" onAction="#handleReturnSelected" styleClass="btn-primary"/>
                </HBox>

                <Label fx:id="loanMsgLabel" text="" styleClass="msg"/>

                <TableView fx:id="loanTable" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn fx:id="colLoanId" text="ID" prefWidth="80"/>
                        <TableColumn fx:id="colLoanBook" text="Buku" prefWidth="320"/>
                        <TableColumn fx:id="colLoanDate" text="Tanggal Pinjam" prefWidth="160"/>
                        <TableColumn fx:id="colDueDate" text="Jatuh Tempo" prefWidth="160"/>
                        <TableColumn fx:id="colStatus" text="Status" prefWidth="160"/>
                        <TableColumn fx:id="colFine" text="Denda" prefWidth="120"/>
                    </columns>
                </TableView>
            </VBox>

        </VBox>
    </center>

</BorderPane>
